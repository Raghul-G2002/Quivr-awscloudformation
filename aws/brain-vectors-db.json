{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Creating RDS Aurora DB for Brain Vectors DB",
    "Resources": {
        "DbSecret2": {
            "Type": "AWS::SecretsManager::Secret",
            "Properties": {
                "KmsKeyId": "alias/aws/secretsmanager",
                "GenerateSecretString": {
                    "ExcludeLowercase": false,
                    "ExcludeNumbers": false,
                    "ExcludePunctuation": false,
                    "ExcludeUppercase": false,
                    "PasswordLength": 32,
                    "ExcludeCharacters": "/\"@\\"
                }
            }
        },
        "RdsCluster2": {
            "Type": "AWS::RDS::DBCluster",
            "Properties": {
                "Engine": "aurora-mysql",
                "EngineVersion": "5.7.mysql_aurora.2.10.0",
                "DBClusterIdentifier": "aurora-mysql-cluster",
                "DBSubnetGroupName": "custom-subnet-group",
                "MasterUsername": "dbadmin",
                "MasterUserPassword": {
                    "Fn::Sub": "{{resolve:secretsmanager:${DbSecret2}}}"
                },
                "Port": "3306",
                "DatabaseName": "brain-vectors-db",
                "StorageEncrypted": false,
                "BackupRetentionPeriod": 1,
                "DeletionProtection": false
            }
        },
        "RdsClusterInstance21": {
            "Type": "AWS::RDS::DBInstance",
            "Properties": {
                "Engine": "aurora-mysql",
                "DBClusterIdentifier": {
                    "Ref": "RdsCluster2"
                },
                "DBInstanceIdentifier": "aurora-mysql-clusterInstance1",
                "DBInstanceClass": "db.t3.medium",
                "DBSubnetGroupName": "custom-subnet-group"
            }
        }
    }
}